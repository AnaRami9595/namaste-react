ğŸŸ¡-----REACTâš›ï¸ ReduxğŸ¤------

It is an open source JSğŸŸ¨ library for managind and
centralizing application state.
It is not mandatory to use ReduxğŸ¤, local
statesâ˜ï¸ are perfectly fine, however it can be used
for large applications in order to make them behave
consistently despite being larga. 
You can also use other libraries such as zustand.

In this time we will be using the library
ReduxğŸ¤ toolkitğŸ”¨
which is the standard way of using redux currently


ğŸŸ¡-----TheoryğŸ“• ReduxğŸ¤------
ReduxğŸ¤ storeğŸª is like a central global object 
with a lot of data inside it, it's kept in a global
central place.

Redux storeğŸª has internal sections called slicesğŸ•
that are useful to keep data separate in logical
partitions.

So if we wanted to add cartğŸ›’ data inside our ReduxğŸ¤
storeğŸª, we will have to create a cartğŸ›’ sliceğŸ•

But how can we add data to our cartğŸ›’ slice from
our menu using the addâ• button?

When you click the addâ• button it should âœ¨dispatch
an actionğŸ¬âœ¨
after âœ¨dispatching the actionğŸ¬âœ¨, it calls a 
functionğŸ“½ï¸, and the functionğŸ“½ï¸ modifies the cartğŸ›’
But what is the funtionğŸ“½ï¸ exactly?
it is called a reducerâœ‚ï¸ function 

If we want to keep loggedInUserğŸ‘¤ inside our ReduxğŸ¤
store, we will have to create a user slice


ğŸ”¸So to summarize, This is how you writeâœï¸ DatağŸ§®
when you click the addâ• button 
it disptches an actionğŸ¬
which calls the reducerâœ‚ï¸ function
which updates the sliceğŸ• 
of our Redux storeğŸª
(see folder for drawing)

ğŸ”¸This is how you readâœï¸ DatağŸ§®
In order to get our cartğŸ›’ componentğŸ§© to read the
data inside our cartğŸ›’ sliceğŸ• and display it 
in the UIğŸ–¼ï¸, 

For that we use a selectorğŸ¯
it will read our info from our storeğŸª 
and modify our REACTâš›ï¸ cartğŸ›’ componentğŸ§©
giving them DatağŸ§®.
That process is known as âœ¨suscribingâœ¨ to the storeğŸª
So the header componentğŸ§© will be suscribed to our store

meaning it is in sync wit the store. ReduxğŸ¤
wil automatically update the data inside our componentğŸ§©



ğŸŸ¡-----Building ReduxğŸ¤ storeğŸª------
Let's create a cartğŸ›’ flow (addint things to
our cart and then visualize them inside cartğŸ›’
componentğŸ§©)

For that we will need to get our REACTâš›ï¸ toolkitğŸ”¨
ready, here's a roadmap of what we will do:

    ğŸ”¸Building our ReduxğŸ¤ feature, roadmap:

    - Install @reduxjs/toolkit and react-redux
    - Build our storeğŸª
    - Connect our storeğŸª to our app
    - SliceğŸ• (cartSlice)ğŸ›’
    - dispatch (action)ğŸ¬
    - SelectorğŸ¯

    ğŸ”¸Installing Redux Toolkit:

            //ğŸ’»In the terminal:
            >npm i @reduxjs/toolkit
            >npm i react-redux

    ğŸ”¸Building our storeğŸª:
    -Inside our utils:
    Let's create a storeğŸª inside our utils, we
    will call it 'appStore', in it, we will use
    the function configureStore() that we will import
    from "@reduxjs/toolkit"

            //ğŸ’»Inside appStore.jsğŸŸ¨
            import { configureStore } from "@reduxjs/toolkit";
            const appStore = configureStore({
            // Here we will add the slicesğŸ•
            });
            export default appStore;

    ğŸ”¸Let's PROVIDE the storeğŸª to our application:
    -Inside of App.jsğŸŸ¨ we will locate the root of our
    application. in order to do that we will need a 
    Provider componentğŸ§©, once again imported from
    ReduxğŸ¤, but this time from the "react-redux"
    library

    ğŸ¤”Why do we do import it from a different library?
    In this case, "react-redux" is functioning like a 
    bridge between ReduxğŸ¤ and REACTâš›ï¸ so we can apply
    ReduxğŸ¤functionalities to our app. 

            //ğŸ’»Inside App.jsğŸŸ¨
            import { Provider } from "react-redux";

    Now that we have imported it, let's wrap our app's 
    root inside the ReduxğŸ¤ provider and pass the store
    as a prop, the store will take our appStore util that
    we just created:

          //ğŸ’»Inside App.jsğŸŸ¨
          ...
          const AppLayout = () => {
        ...
        return(
           ğŸ‘‰ <Provider store={appStore}>
        <UserContext.Provider value={{
            loggedInUser: userName,
            setUserName
        }}>
            <div className="app">
                <UserContext.Provider value={{ loggedInUser: 
                "La Pollohontas" }}>
                    <Header />
                </UserContext.Provider>

                <Outlet />
            </div>
        </UserContext.Provider>
        ğŸ‘‰</Provider>
        )
          }


    ğŸ”¸Let's create our cartğŸ›’ sliceğŸ•!
    we will need another utils file. This time I created a "redux"ğŸ“ folder
    inside our utils to keep ReduxğŸ¤ componentsğŸ§© separate.
    Inside we'll create another file called "cartSlice.jsğŸŸ¨". In order to
    create a ReduxğŸ¤ sliceğŸ• we will use the function createSlice():


        //ğŸ’»Inside cartSlice.jsğŸŸ¨
          import { createSlice } from "@reduxjs/toolkit";

            const cartSlice = createSlice({
            name: 'cart',
            initialState: {
                items: []//â¬…ï¸the initial state will be an empty array
            },
            reducers: {//actions here â¬‡ï¸, they can take 2 args, state and action:
                addItem: (state, action) => {
                    //our reducer functionâ¬†ï¸, modifies data inside the slice
                    ////and mutates the stateâ˜ï¸

                    state.items.push(action.payload);
                    //â¬†ï¸when dispatching on add button we'll get the payload
                },
                removeItem: (state) => {
                    state.items.pop()
                    /*â¬†ï¸Another action that will remove an item from the end
                    of the item's array. This time we will do it like this
                    for simplicity but we can also add the logic to 
                    deleting an item depending on the selected index */
                },
                clearCart: (state) => {
                    state.items.length = 0;
                }
            }
            })

            /*Now we'll export actions and the reducer, with a syntax given â¬‡ï¸
            by react*/
            export const { addItem, removeItem, clearCart } = cartSlice.actions;
            export default cartSlice.reducer;

    ğŸ¤”But what will happen behind the scenes?
    this createSlice() function will return an object like this:

                {
                    ations:{
                        addItem()=>{...},
                        removeItem()=>{...},
                        clearCart()=>{...}
                    }
                    reducer:...
                }


    ğŸ”¸Let's add this sliceğŸ• to the storeğŸª, we will make
    an arg called 'reducer'âœ‚ï¸ that will contain the
    reducers of all our slicesğŸ•. In this case, we only
    have a cartğŸ›’ sliceğŸ•, we will import it as 
    `cartReducer`

        //ğŸ’»Inside appStore.jsğŸŸ¨:
            ...
            import cartReducer from "../redux/cartSlice"

            const appStore = configureStore({

                reducer:{//here the reducers for all the slicesğŸ•
                    cart: cartReducer,
                    //user: userReducer,ğŸ‘¤
                    //location: locationReducerğŸ“
                }

            });

            export default appStore;


    ğŸ”¸In order to make the cartğŸ›’ work, now we need to suscribe 
    it to the storeğŸª using a selectorğŸ¯
    Let's start with the UI. Our cart icon is inside the Header.jsğŸŸ¨
    componentğŸ§©. Right now it looks something like this:
          
          //ğŸ’»Inside Header.jsğŸŸ¨
            const Header = () => {
                return(
                    ...
                    <div>
                        <ul>
                        ...
                        ğŸ‘‰<li>ğŸ›’ <span>(0 items)</span></li>
                        ...
                        </ul>
                    </div>
                    ...
                )
            }

    //ğŸ¤”But how will we modify the number of items according
    of what we add inside the cart?


    ğŸ”¸Using a selectorğŸ¯ of course, which is nothing but
    a hookğŸª inside REACTâš›ï¸, and what is a hookğŸª?
    at the end of the day is a normal utility function!
    Let's import it from the react-redux library and use
    the hook to get the amount of items inside our cartğŸ›’:

        //ğŸ’»Inside Header.jsğŸŸ¨
            ...
            import { useSelector } from "react-redux"

                //Suscribing to the storeğŸª using a Selectorâ¬‡ï¸:
                ğŸ‘‰const cartItems = useSelector(store => store.cart.items)
                //now the cartğŸ›’ will get the data of the items

                        const Header = () => {
                            return(
                                ...
                                <div>
                                    <ul>
                                    ...
                                    ğŸ‘‰<li>ğŸ›’ <span>(cartItems.length)</span></li>
                                    //will show the number of Items nowâ¬†ï¸
                                    ...
                                    </ul>
                                </div>
                                ...
                            )
                        }

  ğŸ”¸Now let's write the code to add items to our cartğŸ›’ so our UIğŸ–¼ï¸ can work
    properly while pressing the addâ• button that is besides every Item of our
    menu: 
        1. First import the useDispatch() hookğŸªfrom react-redux in order
        to perform an actionğŸ¬.
        2. then import our actionğŸ¬, addItem, that we created in our cartSlice
        3. Next, create a handleAddItem functionğŸ“½ï¸ to add to our button later.
           this will call our useDispatch hookğŸªthat will give us access to our
           addItem() action. As args for addItem, we will use the Items pass inside
           our ItemList componentğŸ§©,
        4. Add an onClick attribute in our button that will callback our handleAddItem
           functionğŸ“½ï¸.

        //ğŸ’»Inside ItemList.jsğŸŸ¨

            1ï¸âƒ£import { useDispatch } from "react-redux";
            2ï¸âƒ£import { addItem } from "../../utils/redux/cartSlice";

            ...
            3ï¸âƒ£const dispatch = useDispatch()
            const handleAddItem = (item) => {
                //dispath an action
                ğŸ‘‰dispatch(addItem(item));
                //whatever is the argument of our action addItem, will be our PAYLOAD,
                //This will create an obj for the action, with the property payload
                //wich value will be the arg.
                //this arg will be accesed inside our cart slice
            }

            const ItemList = (props) => {
                ...
                return (
                    ...
                    <div>
                    ...
                    4ï¸âƒ£<button onClick={()=>handleAddItem(items)}> Add + </button>
                    
                    ...
                    </div>
                )
            }

  ğŸ”¸Now let's make our Items appear inside a CartğŸ›’ componentğŸ§©.
  Since every item added will be an array of objects, I created a new componentğŸ§©
  to display a card for each item called "CartItemsList"
  this is how it works:


        //ğŸ’»Inside CartItemList.jsğŸŸ¨
            import { useDispatch } from "react-redux";
            import { CDN_URL } from "../utils/constants";
            import { addItem } from "../utils/redux/cartSlice";

            const CartItemsList = ({ items }) => {

                const dispatch = useDispatch();
                const handleAddItem = (item) => {
                    // Dispatch an action
                    dispatch(addItem(item));
                };
                return (
                    <div>
                        {items.map((item) => (
                            <div
                                data-testid="foodItems"
                                key={item.card.info.id}
                                >
                                <div>
                                    <div>
                                        <span>{item.card.info.name}</span>
                                        <span>
                                            - â‚¹
                                            {item.card.info.price}
                                        </span>
                                    </div>
                                    <p>{item.card.info.description}</p>
                                </div>
                                <div>
                                    <div>
                                        <button onClick={() => handleAddItem(item)}
                                        >
                                            Add +
                                        </button>
                                    </div>
                                    <img src={CDN_URL + item.card.info.imageId} />
                                </div>
                            </div>
                        ))}
                    </div>

                );
            }

            export default CartItemsList;

  ğŸ”¸Every time we add an item to our Cart, it will look like a cart!
  To finish our feature, let's add a "Clear cart" button in our
  CartğŸ›’ componentğŸ§©:

        //ğŸ’»Inside CartItemList.jsğŸŸ¨
            import { useSelector } from "react-redux";
            import CartItemsList from "../CartItemsList.js";
            import { useDispatch } from "react-redux";
            import { clearCart } from "../../utils/redux/cartSlice";
            ...
            const Cart = () => {

            const dispatch = useDispatch();
            ğŸ‘‰const handleClearCart = () => {
                dispatch(clearCart())
            }

            const cartItems = useSelector((store) => store.cart.items)
            return (
                <div>
                    <h1>Cart</h1>
                    <div>
                        ğŸ‘‰<button
                            onClick={handleClearCart}>Clear Cart</button>
                        {cartItems.length === 0 && <h1>Cart is empty</h1>}
                        <CartItemsList items={cartItems} />
                    </div>

                </div>
            );
        }


ğŸŸ¡-----TheoryğŸ“• ReduxğŸ¤- Good Practices âœ…------

    ğŸ”¹ğŸ’¡Interview questionğŸ’¡
    â—Whenever you're doing a selector, make sure to suscribe
    to the right portion of the storeğŸª, if you don't, it will
    be a big performance store.
    What do we mean? let's use an example of code already written
    and compare it to the wrong way to do things::

        //ğŸ’»Inside CartItemList.jsğŸŸ¨
            ...
            const Cart = () => {
                ğŸ‘‰const cartItems = useSelector((store) => store.cart.items)
                ...
            }
            //Here we are suscribing directly to itemsâœ…
        
        ğŸ†š:

         //ğŸ’»Inside CartItemList.jsğŸŸ¨
                const Cart = () => {
                ğŸ‘‰const store = useSelector((store) => store)
                const cartItems = store.cart.items
                ...
            }
            //Here we are NOT suscribing directly to itemsâŒ
            //But we are suscribing to the whole storeğŸª
        

        The last Example will work as well but is much less efficient.
        Because the componentğŸ§© will get updated after ANY update in
        the storeğŸª, regardless if it is relevant to our componentğŸ§©
        or notğŸ˜±


    ğŸ”¹What you need to know about Reducersâœ‚ï¸:
    There's a lot of confusion between reducerâœ‚ï¸, reducer functionsğŸ“½ï¸,
    etc. 
    When you are creating a. appStore like this:

         //ğŸ’»Inside utils/appStore.jsğŸŸ¨
            const appStore = configureStore({

                ğŸ‘‰reducer: {
                    cart: cartReducer,
                }

            });

    the keyword "reducer" refers to a BIG Reducerâœ‚ï¸
    and this Big Reducerâœ‚ï¸ can have multiple small
    reducersâœ‚ï¸ inside.

    But when we are creating a sliceğŸ• like this:

         //ğŸ’»Inside utils/cartSlice.jsğŸŸ¨
         ...
            const cartSlice = createSlice({
                name: 'cart',
                initialState: {
                    items: []
                },
                ğŸ‘‰reducers: {
                    addItem: (state, action) => {
                        state.items.push(action.payload);
                    },
                    removeItem: (state) => {
                        state.items.pop()
                    },
                    clearCart: (state) => {
                        state.items.length = 0;//[]
                    }
                }
            })
            export const { addItem, removeItem, 
            clearCart } = cartSlice.actions;
            ğŸ‘‰export default cartSlice.reducer;
    
    We create multiple reducersâœ‚ï¸, and then we export it as 
    a single reducerâœ‚ï¸, a combination of small
    reducer functionsğŸ“½ï¸